---
import '../styles/global.css';

interface Props {
	title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="Formulary Package Registry" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Space+Mono&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/theme-toggles@4.10.1/css/within.min.css">
		<title>{title} | Formulary</title>
        <script is:inline>
            // Prevent theme flash
            const theme = (() => {
                if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
                    return localStorage.getItem('theme');
                }
                if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    return 'dark';
                }
                return 'light';
            })();
            document.documentElement.setAttribute('data-theme', theme);
        </script>
	</head>
	<body>
        <header>
            <div class="container" style="display: flex; align-items: center; justify-content: space-between; height: 80px;">
                <a href="/" style="font-weight: 700; font-size: 1.5rem; color: var(--color-text); display: flex; align-items: center; gap: 0.5rem;">
                    Formulary
                </a>
                <nav style="display: flex; align-items: center; gap: 2rem;">
                    <button
                        id="theme-toggle"
                        class="theme-toggle"
                        type="button"
                        title="Toggle theme"
                        aria-label="Toggle theme"
                        style="--theme-toggle-duration: 1200ms;"
                    >
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            aria-hidden="true"
                            class="theme-toggle__within"
                            height="2em"
                            width="2em"
                            viewBox="0 0 32 32"
                            fill="currentColor"
                        >
                            <clipPath id="theme-toggle__within__clip">
                            <path d="M0 0h32v32h-32ZM6 16A1 1 0 0026 16 1 1 0 006 16" />
                            </clipPath>
                            <g clip-path="url(#theme-toggle__within__clip)">
                            <path d="M30.7 21.3 27.1 16l3.7-5.3c.4-.5.1-1.3-.6-1.4l-6.3-1.1-1.1-6.3c-.1-.6-.8-.9-1.4-.6L16 5l-5.4-3.7c-.5-.4-1.3-.1-1.4.6l-1 6.3-6.4 1.1c-.6.1-.9.9-.6 1.3L4.9 16l-3.7 5.3c-.4.5-.1 1.3.6 1.4l6.3 1.1 1.1 6.3c.1.6.8.9 1.4.6l5.3-3.7 5.3 3.7c.5.4 1.3.1 1.4-.6l1.1-6.3 6.3-1.1c.8-.1 1.1-.8.7-1.4zM16 25.1c-5.1 0-9.1-4.1-9.1-9.1 0-5.1 4.1-9.1 9.1-9.1s9.1 4.1 9.1 9.1c0 5.1-4 9.1-9.1 9.1z" />
                            </g>
                            <path
                            class="theme-toggle__within__circle"
                            d="M16 7.7c-4.6 0-8.2 3.7-8.2 8.2s3.6 8.4 8.2 8.4 8.2-3.7 8.2-8.2-3.6-8.4-8.2-8.4zm0 14.4c-3.4 0-6.1-2.9-6.1-6.2s2.7-6.1 6.1-6.1c3.4 0 6.1 2.9 6.1 6.2s-2.7 6.1-6.1 6.1z"
                            />
                            <path
                            class="theme-toggle__within__inner"
                            d="M16 9.5c-3.6 0-6.4 2.9-6.4 6.4s2.8 6.5 6.4 6.5 6.4-2.9 6.4-6.4-2.8-6.5-6.4-6.5z"
                            />
                        </svg>
                    </button>
                    <a href="https://github.com/Astral1119/formulary" target="_blank" style="color: var(--color-text-muted); font-size: 0.9rem;">GitHub</a>
                </nav>
            </div>
        </header>
		<main class="container">
			<slot />
		</main>
        <footer style="margin-top: 4rem; padding: 2rem 0; text-align: center; color: var(--color-text-muted); border-top: 1px solid var(--color-border);">
            <div class="container">
                <p>Formulary Registry &copy; {new Date().getFullYear()}</p>
            </div>
        </footer>

        <script>
            const themeToggle = document.getElementById('theme-toggle');
            
            const currentTheme = document.documentElement.getAttribute('data-theme');
            if (currentTheme === 'dark') {
                themeToggle?.classList.add('theme-toggle--toggled');
            }
            
            themeToggle?.addEventListener('click', () => {
                const currentTheme = document.documentElement.getAttribute('data-theme');
                const nextTheme = currentTheme === 'dark' ? 'light' : 'dark';
                
                themeToggle.classList.toggle('theme-toggle--toggled');
                
                document.documentElement.setAttribute('data-theme', nextTheme);
                localStorage.setItem('theme', nextTheme);
            });
        </script>
	</body>
</html>
